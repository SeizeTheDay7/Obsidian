- [[#프로세스와 쓰레드의 차이|프로세스와 쓰레드의 차이]]
	- [[#프로세스와 쓰레드의 차이#ver.1|ver.1]]
	- [[#프로세스와 쓰레드의 차이#ver.2|ver.2]]
- [[#멀티프로세스와 멀티쓰레드의 차이|멀티프로세스와 멀티쓰레드의 차이]]


## 프로세스와 쓰레드의 차이

### ver.1

프로세스는 실행 중인 프로그램의 인스턴스를 의미합니다. 각 프로세스는 고유한 메모리 공간을 할당 받습니다. 한 프로세스는 다른 프로세스의 메모리에 직접 접근할 수 없기 때문에, 한 프로세스가 오류를 일으켜도 다른 프로세스는 안전하게 돌아갈 수 있습니다. 프로세스가 할당받는 메모리 공간에는 스택 영역, 힙 영역, 데이터 영역, 코드 영역이 있습니다.

쓰레드는 프로세스 내에서 실행되는 여러 흐름 중 하나입니다. 같은 프로세스에 있는 쓰레드들은 프로세스의 힙 영역, 데이터 영역, 코드 영역을 공유합니다. 이로 인해 쓰레드 간 컨텍스트 스위칭을 할 때 CPU 레지스터와 스택 포인터만 교체해주면 되므로 비용이 적게 듭니다. 또한 전역 변수나 힙 메모리를 통해 쓰레드 간의 데이터를 쉽게 공유할 수 있습니다. 하지만 동일한 메모리 공간을 공유하므로 경쟁 조건, 데드락 등 동기화 문제가 발생할 수 있습니다. 이를 방지하기 위해 뮤텍스, 세마포어, 조건 변수 등의 동기화 메커니즘을 사용합니다.

### ver.2

프로세스와 쓰레드의 차이점을 설명하기 위해선 먼저 프로그램이 뭔지 알아야 합니다.
프로그램은 디스크에 저장되어 있는 명령어 모음입니다.
프로그램이 메모리 공간을 할당받으면 프로세스가 생성됩니다.

프로세스가 할당받은 메모리 영역은
코드가 저장되는 text 영역,
전역 변수가 저장되는 data 영역,
함수의 지역 변수가 저장되는  stack 영역,
malloc이나 새로 생성되는 인스턴스와 같이 동적으로 할당되는 데이터들을 위한 heap 영역
이렇게 네 가지로 분류될 수 있습니다.

stack 영역은 메모리 주소가 점점 낮아지면서 성장하고,
heap 영역은 메모리 주소가 점점 높아지면서 성장합니다.
이 둘이 점점 커지다가 충돌하면 나는 오류가 스택 오버플로우입니다.

쓰레드는 프로세스에서 진행되는 작업 흐름을 이야기합니다.
한 프로세스에는 여러 개의 쓰레드가 있을 수 있고, 이것을 멀티쓰레드라고 합니다.
각각의 스레드는 별도의 stack을 가지고 있고, 나머지 text, data, heap 영역의 데이터는 공유합니다.

참고로, 프로세스는 기본적으로 다른 프로세스와 메모리를 공유하지 않습니다.
자원이나 정보를 공유하려면 IPC(Inter-Process Communication)이나
LPC(Local inter-Process Communication)을 사용하거나,
별도로 공유 메모리를 만들어야 정보를 주고 받을 수 있습니다.
하지만 이렇게 하면 쓰레드끼리 정보를 공유하는 것보다 자원이 많이 사용됩니다.
(IPC와 LPC가 뭔지?)

다시 쓰레드로 돌아와서,
각각의 프로세스에는 여러 개의 쓰레드가 있다고 했었습니다.
프로세스 역시 여러 개가 있기 때문에 다들 필요할 때마다 CPU에 처리를 요청합니다.
하지만 CPU의 코어 수는 한정되어 있기 때문에, 동시에 연산할 수 있는 쓰레드의 수도 한정되어 있습니다.
따라서 컴퓨터는 프로세스들을 빠르게 번갈아가며 작업들을 처리하는데,
이것을 Context Switching이라 합니다.
(Context Switching이 뭔지?)


## 멀티프로세스와 멀티쓰레드의 차이

멀티프로세스와 멀티쓰레드의 차이점을 설명하기 위해선 먼저 프로그램이 뭔지 알아야 합니다.
프로그램이 뭐냐? 이건 그냥 디스크에 저장된 명령어 덩어리입니다. 
돌 좀 캐라.. 나무 좀 패라... 이렇게 할 일들이 적혀져있는 쪽지라고 보면 됩니다.

쪽지에 적힌대로 작업을 하려면 일꾼이 필요하겠죠? 이게 CPU입니다.
CPU한테 이런 일 해줘~ 라고 전달하기 위해서 메모리에다 프로그램을 복사해서 올려놓습니다. 
이렇게 메모리에 올라가있는 프로그램이 프로세스입니다.

그리고 프로세스에 적힌 명령어들을 비슷한 것들끼리 묶은게 쓰레드입니다.
돌을 캐려면 삽을 가져온다 밭에 간다 돌을 캔다 이렇게 한 묶음,
나무를 패려면 도끼를 가져온다 숲에 간다 나무를 팬다 이렇게 한 묶음.

일꾼 1,2,3한테 쪽지를 여러 개 주고 똑같은 일들을 시키는게 멀티프로세스고,
일꾼 1,2,3한테 쪽지를 여러 부분으로 찢어서 다른 일들을 시키는게 멀티쓰레드입니다.

멀티프로세스는 일꾼이 하나 쓰러져도 일단 원하던 바는 되겠죠? 어쨌든 돌은 캐올거고 나무는 패올거잖아요?
멀티쓰레드는 일꾼이 하나 쓰러지면 나머지가 다 망가질 수가 있습니다. 나 나무 패야되는데 도끼를 안 가져다줘.
이런 경우가 생길수도 있으니까요.
그대신 멀티프로세스는 일꾼끼리 소통을 하려고 해도 
일꾼 1은 지리산에 가서 일하고 있고
일꾼 2는 설악산에 가서 일하고 있습니다. 
그래서 멀티쓰레드에 비해 작업 상황에 대한 통신이 어렵습니다.